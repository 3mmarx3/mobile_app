<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>شوب أدمن - لوحة التحكم</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../style/style.css">
</head>
<body>

        <header id="header"></header>
    <div class="main-content">
        <div class="header d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center gap-3">
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                <h2 class="mb-0" id="page-title">إدارة المنتجات</h2>
            </div>
            <div class="user-info">
                <span>مرحباً، <strong>المشرف العام</strong></span>
                <img src="https://ui-avatars.com/api/?name=المشرف+العام&background=6366f1&color=fff" alt="المشرف">
            </div>
        </div>

        <div id="page-container">
       
            <div id="products" class="page active">
                <div class="container-fluid">
                    <div class="d-flex justify-content-between align-items-center mb-4 page-header">
                        <h2 class="mb-0">جميع المنتجات (127)</h2>
                        <a class="btn btn-custom btn-primary" href="./add-product.html">إضافة منتج جديد</a>
                    </div>

                    <div class="card-custom mb-4">
                        <div class="table-responsive table-responsive-custom">
                            <table class="table table-custom">
                                <thead>
                                    <tr>
                                        <th><input type="checkbox" id="selectAllTop"></th>
                                        <th>الصورة</th>
                                        <th>المنتج</th>
                                        <th>الرمز</th>
                                        <th>الفئة</th>
                                        <th>السعر</th>
                                        <th>المخزون</th>
                                        <th>الحالة</th>
                                        <th>الإجراءات</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><input type="checkbox" class="row-check"></td>
                                        <td>
                                            <div class="product-img" style="background-image:url('https://store.storeimages.cdn-apple.com/4982/as-images.apple.com/is/iphone-15-pro-finish-select-202309-6-1inch-bluetitanium?wid=2560&hei=1440&fmt=p-jpg&qlt=95&.v=1692910042170')"></div>
                                        </td>
                                        <td><strong>آيفون 15 برو ماكس</strong></td>
                                        <td>IPH15PRO2025</td>
                                        <td>الهواتف الذكية</td>
                                        <td>
                                            <strong>$1,199.00</strong><br>
                                            <del>$1,399</del>
                                        </td>
                                        <td><span class="badge badge-custom low-stock">23</span></td>
                                        <td><span class="badge badge-custom active">نشط</span></td>
                                        <td>
                                            <a href="#" class="edit" onclick="openEditModal('آيفون 15 برو ماكس','IPH15PRO2025','الهواتف الذكية','1199','1399','23',true)"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
  <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
  <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"/>
</svg></a>
                                            <a href="#" class="delete "  onclick="if(confirm('حذف هذا المنتج؟')) this.closest('tr').remove()">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-octagon" viewBox="0 0 16 16">
  <path d="M4.54.146A.5.5 0 0 1 4.893 0h6.214a.5.5 0 0 1 .353.146l4.394 4.394a.5.5 0 0 1 .146.353v6.214a.5.5 0 0 1-.146.353l-4.394 4.394a.5.5 0 0 1-.353.146H4.893a.5.5 0 0 1-.353-.146L.146 11.46A.5.5 0 0 1 0 11.107V4.893a.5.5 0 0 1 .146-.353zM5.1 1 1 5.1v5.8L5.1 15h5.8l4.1-4.1V5.1L10.9 1z"/>
  <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"/>
</svg>
                                            </a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="modal modal-custom fade" id="editModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">تعديل المنتج</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form id="editForm">
                                    <div class="form-grid-custom mb-3">
                                        <div class="form-group">
                                            <label class="form-label">اسم المنتج *</label>
                                            <input type="text" id="editName" class="form-control" required>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">الرمز</label>
                                            <input type="text" id="editSku" class="form-control">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">الفئة</label>
                                            <input type="text" id="editCategory" class="form-control">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">السعر ($)</label>
                                            <input type="number" step="0.01" id="editPrice" class="form-control" required>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">السعر القديم (اختياري)</label>
                                            <input type="number" step="0.01" id="editOldPrice" class="form-control">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">المخزون</label>
                                            <input type="number" id="editStock" class="form-control" required>
                                        </div>
                                    </div>
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" id="editStatus" checked>
                                        <label class="form-check-label" for="editStatus">
                                            منشور (مرئي)
                                        </label>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إلغاء</button>
                                <button type="button" class="btn btn-primary" onclick="saveProduct()">حفظ التغييرات</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script src="../app/header.js"></script>
    <script>
        function saveToLocalStorage(key, data) {
            localStorage.setItem(key, JSON.stringify(data));
        }

        function getFromLocalStorage(key) {
            const data = localStorage.getItem(key);
            return data ? JSON.parse(data) : null;
        }

        const editModal = new bootstrap.Modal(document.getElementById('editModal'));
        
        document.getElementById('mobileMenuBtn').addEventListener('click', () => {
            document.getElementById('sidebar').classList.toggle('active');
        });

        function logout() {
            if (confirm('هل أنت متأكد من تسجيل الخروج؟')) {
                localStorage.removeItem('adminLoggedIn');
                window.location.href = './auth/login.html';
            }
            return false;
        }

        function openEditModal(name, sku, cat, price, oldPrice, stock, status) {
            document.getElementById('editName').value = name;
            document.getElementById('editSku').value = sku;
            document.getElementById('editCategory').value = cat;
            document.getElementById('editPrice').value = price;
            document.getElementById('editOldPrice').value = oldPrice || '';
            document.getElementById('editStock').value = stock;
            document.getElementById('editStatus').checked = status;
            editModal.show();
        }

        function saveProduct() {
            const name = document.getElementById('editName').value.trim();
            if (!name) {
                alert('اسم المنتج مطلوب!');
                return;
            }
            alert('تم حفظ المنتج!');
            editModal.hide();
        }

        document.getElementById('selectAllTop').addEventListener('click', () => {
            const isChecked = document.getElementById('selectAllTop').checked;
            document.querySelectorAll('.row-check').forEach(cb => cb.checked = isChecked);
        });

        window.addEventListener('resize', () => {
            const sidebar = document.getElementById('sidebar');
            if (window.innerWidth >= 992 && sidebar) {
                sidebar.classList.remove('active');
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            const isLoggedIn = getFromLocalStorage('adminLoggedIn');
            if (!isLoggedIn && window.location.pathname.includes('dashboard')) {
                window.location.href = './login.html';
            }
        });
    </script>
</body>
</html>